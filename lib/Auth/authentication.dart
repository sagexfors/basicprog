//TODO: add all authentication here and decouple things